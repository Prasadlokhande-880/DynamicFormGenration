<div [formGroup]="form" class="m-2 p-2 bg-light rounded">
  <div *ngIf="formControlsData.controls.length > 0">
    <ng-container *ngFor="let control of formControlsData.controls">
      <div [ngSwitch]="control.type">
        <!-- String Input Field -->
        <div *ngSwitchCase="'String'" class="mb-2">
          <label for="{{ control.name }}" class="form-label fw-bold">
            {{ control.label }}
          </label>
          <input
            id="{{ control.name }}"
            type="text"
            class="form-control"
            [formControlName]="control.name"
          />
          <div
            *ngIf="
              form.get(control.name)?.touched && form.get(control.name)?.invalid
            "
            class="text-danger mt-1"
          >
            <div *ngIf="form.get(control.name)?.errors?.['required']">
              This field is required.
            </div>
            <div *ngIf="form.get(control.name)?.errors?.['pattern']">
              Invalid format.
            </div>
          </div>
        </div>

        <!-- Boolean Checkbox Field -->
        <div *ngSwitchCase="'Boolean'" class="form-check mb-2">
          <input
            id="{{ control.name }}"
            type="checkbox"
            class="form-check-input"
            [formControlName]="control.name"
          />
          <label for="{{ control.name }}" class="form-check-label fw-bold">
            {{ control.label }}
          </label>
        </div>

        <!-- Number Counter Field -->
        <div *ngSwitchCase="'Counter'" class="mb-2">
          <label for="{{ control.name }}" class="form-label fw-bold">
            {{ control.label }}
          </label>
          <input
            id="{{ control.name }}"
            type="number"
            class="form-control"
            [formControlName]="control.name"
          />
        </div>

        <!-- Select Dropdown Field -->
        <div *ngSwitchCase="'select'" class="mb-2">
          <label for="{{ control.name }}" class="form-label fw-bold">
            {{ control.label }}
          </label>
          <select
            id="{{ control.name }}"
            class="form-control"
            [formControlName]="control.name"
          >
            <option *ngFor="let option of control.options" [value]="option">
              {{ option }}
            </option>
          </select>
        </div>

        <!-- List Field -->
        <div *ngSwitchCase="'list'" class="border rounded p-1 mb-2 bg-white">
          <div class="card bg-light mb-2">
            <div class="card-header d-flex justify-content-between align-items-center">
              <label class="form-label fw-bold m-0">{{ control.label }}</label>
              <div>
                <button
                  type="button"
                  class="btn btn-primary me-1"
                  (click)="addList(control.controls, control.name, form)"
                >
                  <i class="bi bi-plus-circle me-1"></i>Add List
                </button>
                <button
                  (click)="toggleContent()"
                  class="btn btn-outline-secondary"
                >
                  <i
                    class="bi"
                    [ngClass]="{
                      'bi-chevron-up': isContentVisible,
                      'bi-chevron-down': !isContentVisible
                    }"
                  ></i>
                </button>
              </div>
            </div>
            <div [@slideToggle]="isContentVisible ? 'collapsed' : 'expanded'">
              <div [formArrayName]="control.name">
                <div
                  *ngFor="
                    let item of getFormArray(form, control.name).controls;
                    let i = index
                  "
                  class="mb-1"
                >
                  <div [formGroupName]="i" class="p-1 bg-white rounded">
                    <button
                      type="button"
                      class="btn btn-danger btn-sm mb-1"
                      (click)="removeGroup(i, form, control.name)"
                    >
                      <i class="bi bi-trash me-2"></i>Remove
                    </button>
                    <dynamic-ui
                      [form]="getFormArrayAtIndex(control.name, i, form)"
                      [formControlsData]="control"
                    >
                    </dynamic-ui>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Group Field -->
        <div *ngSwitchCase="'group'" class="border rounded p-1 mb-2 bg-white">
          <label class="form-label fw-bold">{{ control.label }}</label>
          <div [formGroupName]="control.name">
            <dynamic-ui
              [form]="getFormGroup(form, control.name)"
              [formControlsData]="control"
            >
            </dynamic-ui>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</div>
